<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Alleyway Beat Up - Level 1</title>

<style>
body {
  margin: 0;
  background: #111;
  overflow: hidden;
  touch-action: none;
  font-family: sans-serif;
}

#game {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: #222;
}

.entity {
  position: absolute;
  width: 40px;
  height: 40px;
}

#player {
  background: #4caf50;
}

.enemy {
  background: #f44336;
}

#boss {
  background: purple;
  width: 60px;
  height: 60px;
}

#healthContainer {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 200px;
  height: 20px;
  border: 2px solid white;
}

#healthBar {
  height: 100%;
  width: 100%;
  background: lime;
}

#controls {
  position: absolute;
  bottom: 20px;
  left: 20px;
}

.control-btn {
  background: #555;
  color: white;
  padding: 15px;
  margin: 5px;
  border-radius: 8px;
  font-size: 16px;
}

#punchBtn {
  position: absolute;
  bottom: 20px;
  right: 20px;
  background: #ff3d00;
}
</style>
</head>

<body>
<div id="game">

  <div id="healthContainer">
    <div id="healthBar"></div>
  </div>

  <div id="player" class="entity"></div>

  <div class="entity enemy" style="left:300px; top:200px;"></div>
  <div class="entity enemy" style="left:500px; top:300px;"></div>

  <div id="boss" class="entity" style="left:700px; top:200px;"></div>

  <div id="controls">
    <div class="control-btn" id="up">↑</div>
    <div class="control-btn" id="left">←</div>
    <div class="control-btn" id="right">→</div>
    <div class="control-btn" id="down">↓</div>
  </div>

  <div class="control-btn" id="punchBtn">PUNCH</div>

</div>

<script>
const player = document.getElementById("player");
const enemies = document.querySelectorAll(".enemy");
const boss = document.getElementById("boss");
const healthBar = document.getElementById("healthBar");

let playerHP = 100;
let playerX = 100;
let playerY = 100;
let speed = 4;

function updatePlayer() {
  player.style.left = playerX + "px";
  player.style.top = playerY + "px";
}

updatePlayer();

function rectsTouch(a, b) {
  return !(
    a.right < b.left ||
    a.left > b.right ||
    a.bottom < b.top ||
    a.top > b.bottom
  );
}

function punch() {
  enemies.forEach(enemy => {
    if (rectsTouch(player.getBoundingClientRect(), enemy.getBoundingClientRect())) {
      enemy.remove();
    }
  });

  if (rectsTouch(player.getBoundingClientRect(), boss.getBoundingClientRect())) {
    boss.style.display = "none";
    alert("Boss defeated! Level complete!");
  }
}

/* Touch controls */
document.getElementById("up").ontouchstart = () => playerY -= speed * 5;
document.getElementById("down").ontouchstart = () => playerY += speed * 5;
document.getElementById("left").ontouchstart = () => playerX -= speed * 5;
document.getElementById("right").ontouchstart = () => playerX += speed * 5;
document.getElementById("punchBtn").ontouchstart = punch;

/* Keyboard controls */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp" || e.key === "w") playerY -= speed * 5;
  if (e.key === "ArrowDown" || e.key === "s") playerY += speed * 5;
  if (e.key === "ArrowLeft" || e.key === "a") playerX -= speed * 5;
  if (e.key === "ArrowRight" || e.key === "d") playerX += speed * 5;
  if (e.key === " ") punch();
  updatePlayer();
});

/* Enemy damage loop */
setInterval(() => {
  enemies.forEach(enemy => {
    if (rectsTouch(player.getBoundingClientRect(), enemy.getBoundingClientRect())) {
      playerHP -= 5;
    }
  });

  if (rectsTouch(player.getBoundingClientRect(), boss.getBoundingClientRect())) {
    playerHP -= 8;
  }

  if (playerHP < 0) playerHP = 0;
  healthBar.style.width = playerHP + "%";

  if (playerHP === 0) {
    alert("You got knocked out!");
    location.reload();
  }
}, 800);

setInterval(updatePlayer, 16);
</script>
</body>
</html>
